<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="983px" preserveAspectRatio="none" style="width:2478px;height:983px;background:#F5F5F5;" version="1.1" viewBox="0 0 2478 983" width="2478px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="355" x="1065" y="16.708">Needle Sync HAL Component Overview</text><!--MD5=[905e699bea51e0e609c2f24dfb0c6ecc]
cluster Subsystems--><polygon fill="#F5F5F5" points="998,144.9531,1198,144.9531,1205,167.25,1960,167.25,1960,872.9531,998,872.9531,998,144.9531" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="998" x2="1205" y1="167.25" y2="167.25"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="194" x="1002" y="159.9482">NeedleSync Subsystems</text><!--MD5=[d87bb2f65691251a2b425263f9f3f39e]
cluster MotionCore--><polygon fill="#F5F5F5" points="22,619.9531,196,619.9531,203,642.25,774,642.25,774,872.9531,22,872.9531,22,619.9531" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="203" y1="642.25" y2="642.25"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="26" y="634.9482">Motion Planning Core</text><!--MD5=[51f476bef9e21605c71bfc6e045e170b]
entity CmdProcessor--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="165" x="1150.5" y="343.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1145.5" y="348.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1145.5" y="386.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="145" x="1160.5" y="366.9482">Command Processor</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="129" x="1160.5" y="383.2451">(cmd_processor.c)</text><!--MD5=[4e1abd9a271874dace9f3537e329e7b1]
entity NeedleEncoder--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="155" x="1105.5" y="198.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1100.5" y="203.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1100.5" y="241.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="1115.5" y="221.9482">Needle Encoder</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="1115.5" y="238.2451">(encoder_needle.c)</text><!--MD5=[e9830acc759083a4d9c7265a2a8bc29e]
entity MotorEncoder--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="204" x="1740" y="488.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1735" y="493.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1735" y="531.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="156" x="1750" y="511.9482">Sewing Motor Encoder</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="184" x="1750" y="528.2451">(encoder_sewing_motor.c)</text><!--MD5=[63ed2d12a6e9defabfa8b924330a5a29]
entity NeedleState--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="109" x="1391.5" y="343.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1386.5" y="348.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1386.5" y="386.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="1401.5" y="366.9482">Needle State</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="1401.5" y="383.2451">(needle.c)</text><!--MD5=[b4362608e72ef33c663b2c6a9191ab92]
entity SewMac--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="212" x="1562" y="673.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1557" y="678.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1557" y="716.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="166" x="1572" y="696.9482">Sewing Machine Control</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="192" x="1572" y="713.2451">(sewing_machine_control.c)</text><!--MD5=[62dce4b564df55ed15d9948c3a05c380]
entity Governor--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="161" x="1214.5" y="488.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1209.5" y="493.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1209.5" y="531.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="1224.5" y="511.9482">System Governor</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="141" x="1224.5" y="528.2451">(system_governor.c)</text><!--MD5=[f17fa6e71e583a518fb90de8ca8de961]
entity TableControl--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="131" x="1312.5" y="673.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1307.5" y="678.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1307.5" y="716.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="1322.5" y="696.9482">Table Control</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="1322.5" y="713.2451">(table_control.c)</text><!--MD5=[fc99091798d4278ed5647dfbe94dd76f]
entity AxisX--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="1388.5" y="803.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1383.5" y="808.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1383.5" y="846.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1398.5" y="826.9482">Axis Control X</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="103" x="1398.5" y="843.2451">(axis_control.c)</text><!--MD5=[f8b5236cbf06fe6d20bac1f42c630ca6]
entity AxisY--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="123" x="1230.5" y="803.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1225.5" y="808.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1225.5" y="846.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1240.5" y="826.9482">Axis Control Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="103" x="1240.5" y="843.2451">(axis_control.c)</text><!--MD5=[4fcb814e839da0bec6e0906002335b26]
entity MotionUtils--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="125" x="1014.5" y="488.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1009.5" y="493.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1009.5" y="531.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="1024.5" y="511.9482">Motion Utilities</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="1024.5" y="528.2451">(motion_utils.c)</text><!--MD5=[b27101d3ea00ce0a8e91004a8b913797]
entity Planner--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="195" x="563.5" y="673.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="558.5" y="678.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="558.5" y="716.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="159" x="573.5" y="696.9482">S-curve Motion Planner</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="175" x="573.5" y="713.2451">(scurve_step_projector.c)</text><!--MD5=[4ee578d80e30996f5f72861da9bac5d0]
entity Kalman--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="612.5" y="803.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="607.5" y="808.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="607.5" y="846.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="622.5" y="826.9482">Kalman Filter</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="622.5" y="843.2451">(kalman_filter.c)</text><!--MD5=[6da56cafbdf6262ed713daa13fa0494d]
entity WrapMgr--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="143" x="38.5" y="803.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="33.5" y="808.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="33.5" y="846.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="48.5" y="826.9482">Wrap Manager</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="123" x="48.5" y="843.2451">(wrap_manager.c)</text><!--MD5=[20661e6795640bba9a4019b155b13893]
entity PhaseTracker--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="195" x="216.5" y="803.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="211.5" y="808.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="211.5" y="846.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="226.5" y="826.9482">Needle Phase Tracker</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="175" x="226.5" y="843.2451">(needle_phase_tracker.c)</text><!--MD5=[a9c3eb16d665b9cc179769351c34c3bf]
entity SCurveMath--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="447" y="803.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="442" y="808.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="442" y="846.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="457" y="826.9482">S-curve Math</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="457" y="843.2451">(scurve_math.c)</text><!--MD5=[37bfe02d543aa973178c3a404ceb6060]
entity Loop--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="1767" y="28.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1762" y="33.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1762" y="71.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120" x="1777" y="51.9482">NeedleSync Loop</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="102" x="1777" y="68.2451">(needlesync.c)</text><!--MD5=[d4968cd9e5f2e3984da4b903e7f789a4]
entity StepgenX--><rect fill="#FEFECE" height="36.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1546" y="935.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1541" y="940.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1541" y="962.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="1556" y="958.9482">Stepgen.X</text><!--MD5=[5d38bdc1269fb382cc70e17ca686a877]
entity StepgenY--><rect fill="#FEFECE" height="36.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1083" y="935.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1078" y="940.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1078" y="962.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="1093" y="958.9482">Stepgen.Y</text><!--MD5=[93ad56742d9f6e91e3d9c56fa7462a7a]
entity StepgenSew--><rect fill="#FEFECE" height="36.2969" style="stroke: #A80036; stroke-width: 1.5;" width="152" x="790" y="812.4531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="785" y="817.4531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="785" y="838.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="800" y="835.4482">Stepgen.SewMotor</text><!--MD5=[d8f5c78e6797df505351c844530118de]
entity StitchCtl--><rect fill="#FEFECE" height="52.5938" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="849" y="488.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="844" y="493.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="844" y="531.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="859" y="511.9482">Stitch Controller</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="859" y="528.2451">(stitchctl)</text><!--MD5=[93fdd650f3bbde108d1a0982ba9abe7b]
entity HalPins--><rect fill="#FEFECE" height="36.2969" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="1300" y="935.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1295" y="940.9531"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1295" y="962.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="1310" y="958.9482">HAL Limits &amp; Pins</text><!--MD5=[19012dbafabb2c2da01b33fdf0f548f3]
link Loop to CmdProcessor--><path d="M1766.68,57.9331 C1643.48,62.0731 1396.06,77.7331 1337,136.9531 C1280.76,193.3431 1350.53,245.9931 1309,313.9531 C1302.74,324.2031 1293.81,333.1431 1284.26,340.6731 " fill="none" id="Loop-&gt;CmdProcessor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1280.13,343.8131,1289.716,341.5529,1284.1111,340.7881,1284.8759,335.1832,1280.13,343.8131" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="1385" y="222.52">service</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="1338" y="237.6528">command handshake</text><!--MD5=[cb27f1102607d595f7c4e188ed69dfd1]
link Loop to NeedleEncoder--><path d="M1766.89,58.7231 C1615.74,64.2031 1269.38,80.1131 1227,111.9531 C1201.38,131.2031 1190.67,167.5531 1186.19,193.7331 " fill="none" id="Loop-&gt;NeedleEncoder" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1185.38,198.8331,1190.7433,190.5727,1186.1649,193.8951,1182.8425,189.3168,1185.38,198.8331" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="1228" y="125.02">read counts</text><!--MD5=[a62521c45db19dd9e0a29c73278abae1]
link Loop to MotorEncoder--><path d="M1836.17,82.0431 C1834.78,128.3231 1832.31,229.0231 1834,313.9531 C1835.2,374.1231 1838.42,444.3831 1840.39,483.7231 " fill="none" id="Loop-&gt;MotorEncoder" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1840.65,488.8231,1844.1825,479.6296,1840.3932,483.8297,1836.193,480.0404,1840.65,488.8231" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="1835" y="302.52">read counts</text><!--MD5=[673274abb913f859b779f8df42ee17ed]
link Loop to NeedleState--><path d="M1766.75,62.5431 C1708.18,70.8631 1625.48,90.5231 1569,136.9531 C1503.35,190.9231 1468.14,289.3031 1453.82,338.9931 " fill="none" id="Loop-&gt;NeedleState" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1452.41,343.9331,1458.7078,336.3609,1453.7704,339.1217,1451.0095,334.1843,1452.41,343.9331" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="1591" y="222.52">update</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="1570" y="237.6528">needle timing</text><!--MD5=[fbabe8def460ce01154d3d859f979646]
link Loop to AxisX--><path d="M1907.4,59.8431 C2012.77,65.8631 2205.66,80.8431 2267,111.9531 C2328.54,143.1631 2374,155.4531 2374,224.4531 C2374,224.4531 2374,224.4531 2374,701.4531 C2374,758.8931 2321.31,755.2431 2267,773.9531 C2128.89,821.5131 1686.07,828.4831 1516.72,829.3831 " fill="none" id="Loop-&gt;AxisX" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1511.55,829.4031,1520.5614,833.3774,1516.55,829.3888,1520.5385,825.3774,1511.55,829.4031" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="2380" y="440.02">cycle update</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="2375" y="455.1528">+ safe budget</text><!--MD5=[7d6c07ddaa61ed9473a560a82cab5619]
link Loop to AxisY--><path d="M1907.37,70.6031 C2023.12,95.9131 2241,153.0531 2241,224.4531 C2241,224.4531 2241,224.4531 2241,701.4531 C2241,798.7931 1466.1,783.2131 1371,803.9531 C1366.95,804.8331 1362.82,805.8431 1358.66,806.9331 " fill="none" id="Loop-&gt;AxisY" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1353.79,808.2531,1363.5204,809.7758,1358.6181,806.9533,1361.4406,802.0509,1353.79,808.2531" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="2247" y="440.02">cycle update</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="2242" y="455.1528">+ safe budget</text><!--MD5=[652811db99b6f25e8118b61b2292a925]
link Loop to TableControl--><path d="M1848.75,82.2231 C1852.82,91.5131 1857.3,102.1331 1861,111.9531 C1900.01,215.4431 2027.46,541.7731 1936,603.9531 C1918.03,616.1731 1566.04,606.5431 1545,611.9531 C1499.04,623.7631 1451.57,650.2631 1419.04,671.0231 " fill="none" id="Loop-&gt;TableControl" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1414.75,673.7831,1424.48,672.2576,1418.9494,671.0692,1420.1378,665.5386,1414.75,673.7831" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="1961.5" y="367.52">refresh</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="1953" y="382.6528">axis state</text><!--MD5=[074322b0e289a53a7ac3261d33d3c0c2]
link Loop to SewMac--><path d="M1907.19,74.3931 C1976.44,96.8131 2072,142.5831 2072,224.4531 C2072,224.4531 2072,224.4531 2072,516.4531 C2072,645.4331 1899.03,683.9731 1779.44,695.2031 " fill="none" id="Loop-&gt;SewMac" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1774.15,695.6931,1783.4694,698.8788,1779.1303,695.2495,1782.7596,690.9103,1774.15,695.6931" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="2073" y="367.52">pass needle state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="2116" y="382.6528">+ dt</text><!--MD5=[c63520f203345034c1278492800d3a61]
link Loop to Governor--><path d="M1819.83,82.0231 C1770.53,153.3731 1620.76,356.1531 1445,458.9531 C1425.06,470.6131 1402.23,480.5631 1380.5,488.6731 " fill="none" id="Loop-&gt;Governor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1375.59,490.4831,1385.4182,491.121,1380.281,488.7526,1382.6494,483.6154,1375.59,490.4831" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="1676.5" y="295.02">share table</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="1657" y="310.1528">&amp; sewmac status</text><!--MD5=[b44ab9978c3be60a33fcfe6b4ddf2a41]
link NeedleEncoder to NeedleState--><path d="M1230.02,252.0231 C1276.25,277.1531 1346.64,315.4331 1394.4,341.3931 " fill="none" id="NeedleEncoder-&gt;NeedleState" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1398.95,343.8731,1392.9554,336.0587,1394.5578,341.4839,1389.1326,343.0862,1398.95,343.8731" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="1339" y="302.52">phase, velocity</text><!--MD5=[de4e2cf13185e193f4bb9e50040a39b5]
link NeedleState to SewMac--><path d="M1478.02,397.0731 C1507.1,420.5331 1550.96,456.4531 1588,488.9531 C1614,511.7631 1614.43,525.7631 1645,541.9531 C1697.78,569.9131 1738.78,525.2431 1776,571.9531 C1803.73,606.7531 1759.44,645.6331 1719.49,671.2031 " fill="none" id="NeedleState-&gt;SewMac" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1715.15,673.9431,1724.8952,672.5179,1719.3771,671.2726,1720.6224,665.7545,1715.15,673.9431" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="1646" y="512.52">safe window</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="1657" y="527.6528">&amp; phase</text><!--MD5=[2c1b1bc1985c75d3ae145816a49937ff]
link NeedleState to TableControl--><path d="M1446.37,397.0531 C1447.57,439.7131 1452.55,522.5831 1473,541.9531 C1520.2,586.6531 1720.45,523.6831 1764,571.9531 C1773.53,582.5131 1773.87,593.7131 1764,603.9531 C1755.55,612.7131 1556.77,608.8331 1545,611.9531 C1499.28,624.0931 1451.96,650.4131 1419.42,671.0331 " fill="none" id="NeedleState-&gt;TableControl" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1415.13,673.7731,1424.8695,672.3095,1419.3465,671.086,1420.5701,665.563,1415.13,673.7731" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1474" y="520.02">safe time budget</text><!--MD5=[7434dc7ca1335722dbe79fd5fead7d38]
link NeedleState to Governor--><path d="M1411.66,396.9731 C1400.02,406.0731 1387.15,416.6231 1376,426.9531 C1356.38,445.1331 1335.92,467.2531 1320.48,484.7031 " fill="none" id="NeedleState-&gt;Governor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1317.06,488.5831,1326.0124,484.4777,1320.3667,484.8327,1320.0117,479.187,1317.06,488.5831" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="1377" y="447.52">cycle info</text><!--MD5=[74aa8f14d792182f52c499767846c7e1]
link MotorEncoder to SewMac--><path d="M1829.21,542.1631 C1819.39,560.4931 1804.71,585.1231 1788,603.9531 C1765.36,629.4631 1735.34,653.3531 1710.98,670.8631 " fill="none" id="MotorEncoder-&gt;SewMac" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1706.82,673.8331,1716.4712,671.8697,1710.8925,670.9323,1711.8299,665.3537,1706.82,673.8331" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="1812" y="592.52">motor diagnostics</text><!--MD5=[6c72caf0b4feb2c7985f3cc44a715043]
reverse link CmdProcessor to StitchCtl--><path d="M1171.15,399.1731 C1113.23,425.1431 1027.39,463.6231 971.07,488.8731 " fill="none" id="CmdProcessor&lt;-StitchCtl" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1175.97,397.0231,1166.1212,397.0431,1171.4051,399.0631,1169.3851,404.347,1175.97,397.0231" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="1104" y="447.52">HAL commands</text><!--MD5=[b7b84d6f21c806fb0029d2ab2e251b86]
link CmdProcessor to Governor--><path d="M1226.22,397.1631 C1222.82,415.2731 1221.09,439.6331 1230,458.9531 C1234.59,468.9131 1241.95,477.7431 1250.09,485.2731 " fill="none" id="CmdProcessor-&gt;Governor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1254.15,488.8631,1250.0638,479.902,1250.4067,485.5484,1244.7602,485.8913,1254.15,488.8631" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="1231" y="447.52">parsed requests</text><!--MD5=[616c10ec708cb8e9875a7bafeac92250]
link Governor to TableControl--><path d="M1217.74,542.0331 C1205.11,549.6731 1193.66,559.4631 1186,571.9531 C1178.57,584.0831 1178.51,591.8631 1186,603.9531 C1212.43,646.6131 1264.26,670.8331 1307.42,684.1931 " fill="none" id="Governor-&gt;TableControl" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1312.37,685.6931,1304.9253,679.2451,1307.5868,684.2367,1302.5951,686.8982,1312.37,685.6931" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="1187" y="592.52">stitch/jog orchestration</text><!--MD5=[713d271d0cf8dc88a546fbea84ec2b76]
link TableControl to Governor--><path d="M1373.14,673.9331 C1367.42,647.3931 1356.44,605.1531 1339,571.9531 C1334.37,563.1331 1328.26,554.3431 1322.08,546.4431 " fill="none" id="TableControl-&gt;Governor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1318.65,542.1431,1321.1445,551.6708,1321.7717,546.0489,1327.3937,546.6761,1318.65,542.1431" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="1353" y="585.02">time estimates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="1374" y="600.1528">&amp; status</text><!--MD5=[736e72cf210ad370785e5cefed42d0ac]
link Governor to SewMac--><path d="M1375.64,539.8031 C1402.64,548.6531 1432.58,559.6131 1459,571.9531 C1475.75,579.7731 1566.25,635.8431 1622.53,670.9831 " fill="none" id="Governor-&gt;SewMac" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1626.86,673.6831,1621.3357,665.5295,1622.616,671.0396,1617.1059,672.3199,1626.86,673.6831" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="1510" y="585.02">needle readiness</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="1536.5" y="600.1528">requests</text><!--MD5=[b7b88d62b932671abc0f8486f77e0a0c]
link SewMac to Governor--><path d="M1667.66,673.7731 C1665.77,644.4031 1657.91,597.1231 1628,571.9531 C1589.41,539.4731 1452.61,551.0931 1403,541.9531 C1395.76,540.6231 1388.28,539.1131 1380.79,537.5231 " fill="none" id="SewMac-&gt;Governor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1375.61,536.4131,1383.5605,542.226,1380.4969,537.4705,1385.2524,534.4069,1375.61,536.4131" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="1673.5" y="585.02">safe time</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="1652" y="600.1528">&amp; cycle updates</text><!--MD5=[b817e81d68bd2ac81098ab500039b752]
link TableControl to AxisX--><path d="M1392.4,727.0531 C1404.12,747.8931 1420.7,777.3531 1433.06,799.3331 " fill="none" id="TableControl-&gt;AxisX" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1435.63,803.9031,1434.6933,794.0989,1433.1739,799.5479,1427.7249,798.0286,1435.63,803.9031" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="1419" y="770.02">plan X motion</text><!--MD5=[3afc35f28bc6df2993658afadde68ab4]
link TableControl to AxisY--><path d="M1339.57,727.1731 C1329.36,735.6131 1319.19,745.7431 1312,756.9531 C1303.96,769.4831 1299.12,785.2331 1296.22,798.8431 " fill="none" id="TableControl-&gt;AxisY" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1295.23,803.7531,1300.9264,795.7187,1296.2161,798.8513,1293.0835,794.141,1295.23,803.7531" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="1313" y="770.02">plan Y motion</text><!--MD5=[734c803291d6a90f048a694c6c298bc2]
link AxisX to StepgenX--><path d="M1489.46,857.2031 C1503.05,866.6531 1518.09,877.7831 1531,888.9531 C1546.36,902.2431 1562.13,918.8931 1573.8,931.8731 " fill="none" id="AxisX-&gt;StepgenX" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1577.28,935.7831,1574.2881,926.3997,1573.9573,932.0469,1568.3101,931.716,1577.28,935.7831" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="1549" y="902.02">position commands</text><!--MD5=[984f4808935e8a871c6a5bc5da7e65f2]
link AxisY to StepgenY--><path d="M1230.16,844.3531 C1202.73,852.8931 1171.98,866.7631 1151,888.9531 C1140.31,900.2631 1134.79,916.9931 1131.96,930.5131 " fill="none" id="AxisY-&gt;StepgenY" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1130.96,935.7131,1136.5658,927.6153,1131.891,930.8006,1128.7057,926.1257,1130.96,935.7131" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="1152" y="902.02">position commands</text><!--MD5=[30f24132bc3e6c3ca1830e90d3668d95]
reverse link AxisX to HalPins--><path d="M1432.8,861.6131 C1424.71,875.3631 1414.71,891.7131 1405,905.9531 C1398.05,916.1431 1389.71,927.1031 1382.8,935.8831 " fill="none" id="AxisX&lt;-HalPins" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1435.47,857.0631,1427.4682,862.8052,1432.9418,861.3768,1434.3701,866.8504,1435.47,857.0631" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="1416" y="902.02">X min/max limits</text><!--MD5=[95e43ade93878ff0ecd4e4d72de0b87d]
reverse link AxisY to HalPins--><path d="M1286.46,862.3131 C1285.45,876.4631 1286.57,892.9431 1294,905.9531 C1301.32,918.7631 1313.69,928.5731 1326.3,935.8331 " fill="none" id="AxisY&lt;-HalPins" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1286.91,857.2131,1282.1294,865.8239,1286.4676,862.1935,1290.098,866.5317,1286.91,857.2131" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="1295" y="902.02">Y min/max limits</text><!--MD5=[98808cf0cb9788f5322189fd8fa3db92]
link SewMac to Planner--><path d="M1619.94,673.8531 C1579.04,652.7231 1518.03,624.6831 1461,611.9531 C1383.94,594.7531 1128.58,588.8031 1035.5,600.9531 C932.37,614.4231 817.21,647.9131 742.17,672.3331 " fill="none" id="SewMac-&gt;Planner" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="737.29,673.9231,747.0878,674.9249,742.0419,672.3677,744.5991,667.3218,737.29,673.9231" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="1049" y="585.02">move targets</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="1036.5" y="600.1528">limits &amp; feedback</text><!--MD5=[a188782143afb0a82f4ca5acaeca5e9f]
link Planner to Kalman--><path d="M602.22,726.9931 C582.68,739.3631 568.32,755.5431 579,773.9531 C585.85,785.7631 596.26,795.2731 607.76,802.8531 " fill="none" id="Planner-&gt;Kalman" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="612.04,805.5631,606.5676,797.3745,607.8129,802.8926,602.2948,804.1379,612.04,805.5631" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="580" y="770.02">integrate delayed feedback</text><!--MD5=[f14972df71fbf59ddfcfcee88003f461]
link Planner to SCurveMath--><path d="M563.25,713.9131 C511.24,722.7631 454.8,736.7131 439,756.9531 C426.94,772.3931 438.62,787.9231 455.91,800.6131 " fill="none" id="Planner-&gt;SCurveMath" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="460.42,803.7831,455.3427,795.3438,456.3245,800.9149,450.7535,801.8966,460.42,803.7831" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="440" y="770.02">compute jerk profile</text><!--MD5=[39c72a47c065041c6b9580d9e05913ca]
link Planner to WrapMgr--><path d="M563.5,701.9231 C435.36,704.2431 218.83,714.5631 153,756.9531 C137.84,766.7231 127.31,783.8831 120.46,799.0631 " fill="none" id="Planner-&gt;WrapMgr" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="118.46,803.7031,125.7069,797.0337,120.4468,799.1148,118.3657,793.8547,118.46,803.7031" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="154" y="770.02">unwrap motor space</text><!--MD5=[b8c15101da7350220d0716e74da2b815]
link Planner to PhaseTracker--><path d="M563.37,702.6731 C468.29,706.1731 333.34,718.0931 300,756.9531 C290.1,768.4931 292.38,784.8931 297.67,799.1831 " fill="none" id="Planner-&gt;PhaseTracker" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="299.57,803.9431,299.9675,794.1023,297.7254,799.2958,292.5318,797.0537,299.57,803.9431" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="301" y="770.02">follow needle phase</text><!--MD5=[2c58c1074c1859bf0707737c6b6cd419]
link Planner to StepgenSew--><path d="M707.81,726.9531 C724.17,736.1331 742.55,746.7431 759,756.9531 C786.17,773.8131 816.25,794.3631 837.57,809.2831 " fill="none" id="Planner-&gt;StepgenSew" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="841.72,812.1831,836.6566,803.7355,837.6292,809.3081,832.0566,810.2808,841.72,812.1831" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="784" y="770.02">stp_set_sewmotor_pos_cmd</text><!--MD5=[9e726d69853c8bbe1deee9ae0ab5a426]
reverse link MotionUtils to AxisX--><path d="M1043.68,545.7331 C1028.59,562.6731 1016.26,584.4231 1027,603.9531 C1094.97,727.5531 1168.27,712.0231 1295,773.9531 C1312.01,782.2631 1352.94,796.8431 1388.46,808.9731 " fill="none" id="MotionUtils&lt;-AxisX" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1047.15,541.9831,1038.1082,545.8876,1043.7604,545.6588,1043.9892,551.311,1047.15,541.9831" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[ef00e3d80dd0935bcf20d7ede559127c]
reverse link MotionUtils to AxisY--><path d="M1038.28,545.6931 C1030.85,553.3531 1024.11,562.2231 1020,571.9531 C1008.34,599.5731 996.8,723.6531 1043,773.9531 C1067.83,800.9831 1164.89,816.2831 1230.24,823.7031 " fill="none" id="MotionUtils&lt;-AxisY" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1041.98,542.0331,1032.7734,545.5314,1038.4302,545.5543,1038.4073,551.2111,1041.98,542.0331" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[1843a103367ab87d5573c6477271fd53]
reverse link MotionUtils to TableControl--><path d="M1046.69,546.0031 C1032.17,563.7731 1020.57,586.2931 1034,603.9531 C1034.54,604.6631 1212.5,653.8231 1312.21,681.3231 " fill="none" id="MotionUtils&lt;-TableControl" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1050.02,542.0631,1041.1616,546.3677,1046.798,545.8866,1047.2792,551.5229,1050.02,542.0631" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[c9677e3978fce7cb90b72df219987ecd]
reverse link MotionUtils to Planner--><path d="M1009.54,538.6431 C1004.98,539.8431 1000.44,540.9631 996,541.9531 C897.96,563.7831 860.44,524.3431 772,571.9531 C728.2,595.5331 693.74,643.7831 675.45,673.6931 " fill="none" id="MotionUtils&lt;-Planner" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1014.5,537.3031,1004.7654,535.8073,1009.6755,538.6163,1006.8665,543.5264,1014.5,537.3031" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[bc2ed7f097a4e4c9aebf51c2f5eb8a3b]
link Planner to Governor--><path d="M691.86,673.7531 C729.92,643.6531 797.84,594.9931 865,571.9531 C988.4,529.6131 1027.86,560.4831 1157,541.9531 C1173.83,539.5331 1191.74,536.5431 1208.89,533.4631 " fill="none" id="Planner-&gt;Governor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1214.18,532.5131,1204.6144,530.1681,1209.2588,533.3975,1206.0294,538.0419,1214.18,532.5131" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="866" y="592.52">ETA, status (via SewMac)</text><!--MD5=[40824cf8d36c898f7da1be5b5acb883d]
@startuml
skinparamlocked backgroundColor #f5f5f5
skinparam componentStyle rectangle
skinparam shadowing false
title Needle Sync HAL Component Overview

component "NeedleSync Loop\n(needlesync.c)" as Loop

package "NeedleSync Subsystems" as Subsystems {
  component "Command Processor\n(cmd_processor.c)" as CmdProcessor
  component "Needle Encoder\n(encoder_needle.c)" as NeedleEncoder
  component "Sewing Motor Encoder\n(encoder_sewing_motor.c)" as MotorEncoder
  component "Needle State\n(needle.c)" as NeedleState
  component "Sewing Machine Control\n(sewing_machine_control.c)" as SewMac
  component "System Governor\n(system_governor.c)" as Governor
  component "Table Control\n(table_control.c)" as TableControl
  component "Axis Control X\n(axis_control.c)" as AxisX
  component "Axis Control Y\n(axis_control.c)" as AxisY
  component "Motion Utilities\n(motion_utils.c)" as MotionUtils
}

package "Motion Planning Core" as MotionCore {
  component "S-curve Motion Planner\n(scurve_step_projector.c)" as Planner
  component "Kalman Filter\n(kalman_filter.c)" as Kalman
  component "Wrap Manager\n(wrap_manager.c)" as WrapMgr
  component "Needle Phase Tracker\n(needle_phase_tracker.c)" as PhaseTracker
  component "S-curve Math\n(scurve_math.c)" as SCurveMath
}

component "Stepgen.X" as StepgenX
component "Stepgen.Y" as StepgenY
component "Stepgen.SewMotor" as StepgenSew
component "Stitch Controller\n(stitchctl)" as StitchCtl
component "HAL Limits & Pins" as HalPins

Loop - -> CmdProcessor : service\ncommand handshake
Loop - -> NeedleEncoder : read counts
Loop - -> MotorEncoder : read counts
Loop - -> NeedleState : update\nneedle timing
Loop - -> AxisX : cycle update\n+ safe budget
Loop - -> AxisY : cycle update\n+ safe budget
Loop - -> TableControl : refresh\naxis state
Loop - -> SewMac : pass needle state\n+ dt
Loop - -> Governor : share table\n& sewmac status

NeedleEncoder - -> NeedleState : phase, velocity
NeedleState - -> SewMac : safe window\n& phase
NeedleState - -> TableControl : safe time budget
NeedleState - -> Governor : cycle info
MotorEncoder - -> SewMac : motor diagnostics

CmdProcessor <- - StitchCtl : HAL commands
CmdProcessor - -> Governor : parsed requests

Governor - -> TableControl : stitch/jog orchestration
Governor - -> SewMac : needle readiness\nrequests
TableControl - -> Governor : time estimates\n& status

TableControl - -> AxisX : plan X motion
TableControl - -> AxisY : plan Y motion
AxisX - -> StepgenX : position commands
AxisY - -> StepgenY : position commands
AxisX <- - HalPins : X min/max limits
AxisY <- - HalPins : Y min/max limits

SewMac - -> Planner : move targets\nlimits & feedback
Planner - -> Kalman : integrate delayed feedback
Planner - -> SCurveMath : compute jerk profile
Planner - -> WrapMgr : unwrap motor space
Planner - -> PhaseTracker : follow needle phase
Planner - -> StepgenSew : stp_set_sewmotor_pos_cmd

MotionUtils <- - AxisX
MotionUtils <- - AxisY
MotionUtils <- - TableControl
MotionUtils <- - Planner

Planner - -> Governor : ETA, status (via SewMac)
SewMac - -> Governor : safe time\n& cycle updates

@enduml

PlantUML version 1.2020.02(Sun Mar 01 05:22:07 EST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.16+8-Debian-1deb12u1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>